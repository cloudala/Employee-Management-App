<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title th:text="${pageTitle}">List of Employees</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<!-- Header Fragment -->
<div th:replace="~{fragments/header :: header}"></div>

<div class="container mt-4">
  <div class="alert alert-info">
    <h4>Employee Salary Summary</h4>
    <table class="table table-sm">
      <thead>
      <tr>
        <th>Total Salary</th>
        <th>Currency</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="entry : ${currencySummary}">
        <td th:text="${T(java.lang.String).format('%,.2f', entry.value)}">Amount</td>
        <td th:text="${entry.key}">Currency</td>
      </tr>
      </tbody>
    </table>
  </div>

  <!-- Dropdown Menu -->
  <div class="dropdown mt-3 mb-3">
    <h5>Filter employees by country:</h5>
    <form action="/employees" method="get" class="d-flex align-items-center">
      <select class="form-select me-2 w-25" name="country" id="employeeCountry" aria-label="country">
        <option th:each="employeeCountry : ${employeeCountries}"
                th:value="${employeeCountry}"
                th:text="${employeeCountry}"
                th:selected="${employeeCountry == country}">
        </option>
      </select>
      <button type="submit" class="btn btn-primary me-2 px-3">Filter</button>
      <button type="button" class="btn btn-secondary px-3" onclick="clearFilter()">Show All</button>
    </form>
  </div>

  <!-- Employee Table -->
  <h2>List of Employees</h2>
  <div th:if="${not #lists.isEmpty(employees)}">
    <table class="table">
      <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Surname</th>
        <th>Email</th>
        <th>Company</th>
        <th>Salary</th>
        <th>Currency</th>
        <th>Country</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="employee : ${employees}">
        <td th:text="${employee.id}">1</td>
        <td th:text="${employee.firstName}">ImiÄ™</td>
        <td th:text="${employee.lastName}">Nazwisko</td>
        <td>
          <a th:href="@{/employees/details/{id}(id=${employee.id})}" th:text="${employee.email}">Email</a>
        </td>
        <td th:text="${employee.company}">Firma</td>
        <td th:text="${employee.salary}">Pensja</td>
        <td th:text="${employee.currency}">Waluta</td>
        <td th:text="${employee.country}">Kraj</td>
      </tr>
      </tbody>
    </table>
  </div>

  <div th:if="${#lists.isEmpty(employees)}" class="alert alert-warning">
    Employee database is empty.
  </div>
</div>

<!-- Footer Fragment -->
<div th:replace="~{fragments/footer :: footer}"></div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  function clearFilter() {
    window.location.href = '/employees';
  }
</script>
</body>
</html>
